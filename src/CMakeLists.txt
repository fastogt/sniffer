SET(GLOBAL_HEADERS
)
SET(GLOBAL_SOURCES
)

SET(DATABASE_HEADERS
  ${CMAKE_CURRENT_SOURCE_DIR}/database/connection.h
)

SET(DATABASE_SOURCES
  ${CMAKE_CURRENT_SOURCE_DIR}/database/connection.cpp
)

IF(APPLE)
  SET(PLATFORM_HEADER)
  SET(PLATFORM_SOURCES)
  SET(PLATFORM_LIBRARIES)
ELSEIF(UNIX)
  SET(PLATFORM_HEADER)
  SET(PLATFORM_SOURCES)
  SET(PLATFORM_LIBRARIES rt m z pthread)
ENDIF(APPLE)

FIND_PACKAGE(Cassandra REQUIRED)
FIND_PACKAGE(Common REQUIRED)

INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR} ${COMMON_INCLUDE_DIRS} ${CASSANDRA_INCLUDE_DIRS})

ADD_EXECUTABLE(${PROJECT_NAME}
  ${GLOBAL_HEADERS} ${GLOBAL_SOURCES}
  ${DATABASE_HEADERS} ${DATABASE_SOURCES}
  main.cpp
)

TARGET_LINK_LIBRARIES(${PROJECT_NAME} pcap ${CASSANDRA_LIBRARIES} ${COMMON_LIBRARIES} ${PLATFORM_LIBRARIES})

IF(DEVELOPER_ENABLE_TESTS)
  FIND_PACKAGE(GTest REQUIRED)
  ADD_DEFINITIONS(-DTEST_FOLDER_PATH="${CMAKE_SOURCE_DIR}/tests/")
  SET(UNIT_TESTS_PROJECT_NAME ${PROJECT_NAME}_unit_tests)
  SET(UNIT_TESTS_SOURCES ${CMAKE_SOURCE_DIR}/tests/sniffer_unit_tests.cpp)
  ADD_EXECUTABLE(${UNIT_TESTS_PROJECT_NAME} ${UNIT_TESTS_SOURCES})
  TARGET_LINK_LIBRARIES(${UNIT_TESTS_PROJECT_NAME} ${GTEST_BOTH_LIBRARIES} ${PLATFORM_LIBRARIES})

  SET(INTEGRATION_TESTS_PROJECT_NAME ${PROJECT_NAME}_integration_tests)
  SET(INTEGRATION_TESTS_SOURCES ${CMAKE_SOURCE_DIR}/tests/read_pcap_file.c)
  ADD_EXECUTABLE(${INTEGRATION_TESTS_PROJECT_NAME} ${INTEGRATION_TESTS_SOURCES})
  TARGET_LINK_LIBRARIES(${INTEGRATION_TESTS_PROJECT_NAME} pcap)
ENDIF(DEVELOPER_ENABLE_TESTS)
